var game={stage1:{container:new PIXI.Container(),isMoving:false,movingDirection:""},currentStage:1,renderer:PIXI.autoDetectRenderer(1200,600,{backgroundColor:15657130})};document.getElementById("PlayerCanvasContainer").appendChild(game.renderer.view);createBackground(game.stage1);function createBackground(stage){stage.bg1=new PIXI.extras.TilingSprite(PIXI.Texture.fromImage("pic/gori1.png"),game.renderer.width,game.renderer.height);stage.bg2=new PIXI.extras.TilingSprite(PIXI.Texture.fromImage("pic/gori2.png"),game.renderer.width,game.renderer.height);stage.bg3=new PIXI.extras.TilingSprite(PIXI.Texture.fromImage("pic/gori3.png"),game.renderer.width,game.renderer.height);
stage.bg4=new PIXI.extras.TilingSprite(PIXI.Texture.fromImage("pic/bg1_4.png"),game.renderer.width,game.renderer.height);stage.bg1.position.x=0;stage.bg1.position.y=0;stage.bg2.position.x=0;stage.bg2.position.y=0;stage.bg3.position.x=0;stage.bg3.position.y=0;stage.bg4.position.x=0;stage.bg4.position.y=0;stage.container.addChild(stage.bg1);stage.container.addChild(stage.bg2);stage.container.addChild(stage.bg3)}var playerImages=[];for(var i=1;i<=8;i++){playerImages.push("/pic/player/"+i+".png")}var playerTextureArray=[];for(var i=0;i<playerImages.length;i++){var texture=PIXI.Texture.fromImage(playerImages[i]);
playerTextureArray.push(texture)}var player=new PIXI.extras.MovieClip(playerTextureArray);player.position.x=150;player.position.y=0;player.animationSpeed=0.15;player.currentFrame=0;game.stage1.container.addChild(player);var playerdy=0;var kosterImages=["pic/koster1.png","pic/koster2.png","pic/koster3.png","pic/koster4.png","pic/koster5.png"];var kosterTextureArray=[];for(var i=0;i<5;i++){var texture=PIXI.Texture.fromImage(kosterImages[i]);kosterTextureArray.push(texture)}var koster=new PIXI.extras.MovieClip(kosterTextureArray);koster.position.set(500,200);koster.animationSpeed=0.4;koster.currentFrame=0;
koster.play();game.stage1.container.addChild(koster);var fakel=new PIXI.Sprite(PIXI.Texture.fromImage("pic/fakel.png"));var darkness=new PIXI.Sprite(PIXI.Texture.fromImage("pic/darkness.png"));darkness.anchor.x=0.5;darkness.anchor.y=0.5;darkness.position.x=150;darkness.position.y=50;game.stage1.container.addChild(darkness);var groundFiles=["pic/floor1.png","pic/floor2.png","pic/floor3.png","pic/floor4.png"];var grounds=[];var tshift=0;for(var i=0;i<5;i++){var tground=new PIXI.Sprite(PIXI.Texture.fromImage(groundFiles[getRandomInt(0,groundFiles.length-1)]));tground.position.x=tshift;tground.position.y=425;
tshift+=300;grounds.push(tground);game.stage1.container.addChild(tground)}animate();function animate(){requestAnimationFrame(animate);sleep(10);darkness.position.x-=0.05;if(game.currentStage==1){var stage=game.stage1;if(stage.isMoving){player.play();if(stage.movingDirection=="r"){stage.bg1.tilePosition.x-=0.2;stage.bg2.tilePosition.x-=0.6;stage.bg3.tilePosition.x-=3;stage.bg4.tilePosition.x-=8;for(var i=0;i<grounds.length;i++){grounds[i].position.x-=8}if(grounds[0].position.x<=-300){stage.container.removeChild(grounds[0]);grounds[0].destroy();grounds.splice(0,1);var tground=new PIXI.Sprite(PIXI.Texture.fromImage(groundFiles[getRandomInt(0,groundFiles.length-1)]));
tground.position.x=grounds[grounds.length-1].position.x+300;tground.position.y=425;grounds.push(tground);stage.container.addChild(tground)}}else{stage.bg1.tilePosition.x+=0.2;stage.bg2.tilePosition.x+=0.6;stage.bg3.tilePosition.x+=3;stage.bg4.tilePosition.x+=8;for(var i=0;i<grounds.length;i++){grounds[i].position.x+=8}}}else{player.stop()}game.stage1.container.addChild(darkness);player.position.y+=playerdy;if(playerdy>0){playerdy-=1}else{if(playerdy<0){playerdy+=1}}if(player.position.y<333){player.position.y+=15;if(333-player.position.y<15){player.position.y=333}}else{if(playerdy>0||playerdy<0){playerdy=math.round(playerdy/2)
}}fakel.position.set(player.position.x-30,player.position.y-90)}game.renderer.render(game.stage1.container)}function jumpSound(){soundEffect(523.25,0.05,0.2,"sine",3,0.8,0,600,true,100,0,undefined,undefined)}document.addEventListener("keydown",function(event){if(event.keyCode==32||event.keyCode==87){playerdy=-32;jumpSound()}if(event.keyCode==37||event.keyCode==65){game.stage1.movingDirection="l";game.stage1.isMoving=true}else{if(event.keyCode==39||event.keyCode==68){game.stage1.movingDirection="r";game.stage1.isMoving=true}}});document.addEventListener("keyup",function(event){if(event.keyCode==37||event.keyCode==65){game.stage1.isMoving=false
}else{if(event.keyCode==39||event.keyCode==68){game.stage1.isMoving=false}}});function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}function sleep(ms){ms+=new Date().getTime();while(new Date()<ms){}};